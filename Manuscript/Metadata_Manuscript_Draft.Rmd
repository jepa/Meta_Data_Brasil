---
title: 'Meta-Database of Marine Research in Mexico: Trends and Applications'
author: Palacios-Abrantes, J; Arreguín-Sánchez, F; Cisneros, A; Cisneros-Mata, M.A;
  Rodríguez, L.
date: "4/12/2017"
output:
  word_document:
    fig_height: 3
    fig_width: 4
  pdf_document:
    fig_height: 3
    fig_width: 4
subtitle: Draft
---

```{r setup, eval=T, echo=F, warning=F,message=F}

#Libraries 
library(dplyr)
library(knitr)
library(data.table)
library(ggplot2)

#Data needed

#Template (Updates from App)
# Template <- fread("/Users/jpalacios/Documents/Github/Meta_Data_Mexico/App_Eng/Template.csv",
#                  colClasses = c(Location = 'character',
#                                 Notes = 'character'
# 
#                  )
# )

Template <- read.csv("/Users/jpalacios/Documents/Github/Meta_Data_Mexico/App_Eng/Template.csv")


```

# Introduction

Research and management of marine resources increasingly depends on various biological, ecological, social, and economic data (Mokrane & Parsons, 2004; Reichman et al., 2011). The availability of data is often perceived as a gap in advancing research and policy discussion [cita]. However, in many cases, this is largely a result of the lack of knowledge about the availability of these data (Reichman et al., 2011). In Mexico, numerous information covering the seas and coasts can be found in academic institutions, government, and NGOs located (physically) both inside and outside the country. Scientific institution projects like [DataMares](http://datamares.ucsd.edu/) from the University of San Diego (UCSD) and [UNIMAR](http://www.icmyl.unam.mx/uninmar/) from the National University of Mexico (UNAM) have long shared data trough their portals. Non governmental agencies programs like [*Monitoreo Noroeste*](http://monitoreonoroeste.mx/) provide metadata of marine saplings. Governmental institutions like the National Commission for Biodiversity [(CONABIO)](http://www.conabio.gob.mx/informacion/gis/?vns=gis_root/region/biotic/anpe09gw) hosts one of the largest biodiversity databases of the country. Recently the Mexican president released a decree by which he established a policy on Open Data [DOF: 20/02/2015](http://www.dof.gob.mx/nota_detalle.php?codigo=5382838&fecha=20/02/2015). The initiative Open data (*Datos abiertos*) provides a legal framework for any Mexican citizen to access public data generated by the Mexican government (https://datos.gob.mx/). While these are just some of the data sources available for marine data in Mexico, it provides an idea of the variability that could exists in terms of data structure (e.g units, scales, formats). Moreover, in many cases, data lacks basic information compromising its utilization. Having publicly accessible description on existing data is a huge step towards increasing collaboration and innovative research (Reichman et al., 2011; Heidorn,. 2008).

Data availability is key not only to better understand Mexico's marine and coastal environments, but to identify knowledge gaps so that research can be prioritized (Cisneros-Montemayor et al., 2016). This will facilitate furnishing management and conservation policies, for example, for marine habitats and fisheries resources vulnerable to climate change. Building tools for effectively managing collected data and access while respecting researchers rights to publication is an important step towards data preservation and stewardship (Vincent, et al., 2010). The creation of a meta-database of marine research in Mexico will foster collaboration and eases the process of informing best policies relevant to any community or region in the country.

A meta-database is a documentation of the sources of information instead of a database of the actual data. It describes the "who, what, when, where and how" of the data collected (Michener, 2006). Having a meta-database helps understanding the data, increases data longevity, and enhances collaboration among scientists (Michener, 2006). Moreover, if well documented, the metadata itself could be used to explore science and policy questions (Cisneros-Montemayor et al., 2016; Michener, 2006). 

The current project aimed to create a meta-database for oceanographic, ecological, economic, fisheries and social data for marine ecosystems and marine-related sectors of Mexico. It subsequently analyzed the information collected to determine trends and data gaps in Mexico. The final meta-database is an open source repository for public consultation and sharing.

 
# Materials and Methods

## Data Compilation

Since October 2016 through *November 2017*, information was extracted from several data sources both national and international (Figure 1). For each data type, the data was described by 31 categories (e.g. Title, repository, author, spatial and temporal resolution, etc.) creating the metadata (**APENDIX or describing them?**). When possible, all 31 categories where collected. However, in many cases this was not possible. A sub-group of categories were made mandatory for a database to be included on the metadata. These categories where the institution responsible for the data, a short title describing the data, first and last years of data, and a path to find the data or metadata. 

![Data Gathering Curve](Images/Data_Curve.PNG)

The data search was divided in three stages **(Table 1)**. The first stage target global repositories (e.g. Ocean Bio-geographic Information System (OBIS)), followed by national repositories (e.g. Mexican Fisheries Agency), and regional non-governmental repositories like Monitoreo Noroeste. A second stage target researchers and managers aiming to recover data previously produced but not made available on-line. Professionals were approached at international conferences, workshops, and direct interviews. Finally, a third stage focused the effort on scientific articles and graduate-level thesis. Most Mexican institutions require students to generate a thesis for graduation, sometimes at the undergrad level. Hence, a lot of information that is hardly shared or publicly available is storage in these documents.

```{r Sources, echo=F,eval=T}

table <- matrix(c(
  37,
  40,
  150
),
ncol=3
)
colnames(table) <- c("Stage One", "Stage Two", "Stage Three")

kable(table,
      caption = "Number of different sources at each stage of the data gathering process. Note that each source contained multiple data")

```


# Results

```{r Results, eval=T, echo=F}

Number_entries <- Template %>% 
      filter(MMID != "na")

# Number of metadata registers    
Registers <- Number_entries$MMID[length(Number_entries$MMID)]
# Number of Data Points ####
Data_Points <- sum(Number_entries$Data_Time_Points,na.rm=T)
#Number of Repositories ####
 z<- Template %>% 
      group_by(Compilation_Title) %>% 
      summarise(sum(Data_Time_Points)) %>% 
      select(-2) %>% 
      filter(!is.na(Compilation_Title)) %>% 
      mutate(z = 1)
    
Repo <- sum(z$z)

#Disciplines (Sociology. eg.)
Dis <- levels(Template$Research_Field)

#### Species Information ####

Species <- Number_entries %>%
  filter(Subject_name !="TBD") %>% 
  filter(Subject_name != "Multiple Especies") %>% 
  group_by(Subject_name) %>% 
  summarise(x=sum(Data_Time_Points)) %>% 
  arrange(-x)

Mean <- round(mean(Species$x,
             na.rm = T),
             2)
SD <- round(sd(Species$x,
             na.rm = T),
            2)

```

## General Numbers
The meta-database has `r Registers` records containing information for about `r Data_Points` data points, from `r Repo` repositories. Data gathered was on 5 major disciplines: `Dis` from witch *Fisheries* was the most abundant (Figure 2).

```{r Fig1, eval=T, echo=F, fig.align="center",fig.height=4,fig.width=7,fig.cap="Number of data points per research field."}

Research_F <- Template %>% 
  filter(MMID != "na") %>% 
  group_by(Research_Field) %>% 
  summarise(Entradas = sum(Data_Time_Points,
                           na.rm=T)) %>% 
  filter(Research_Field != "")
  
      
      ggplot(data= Research_F,
             aes(
               x=reorder(Research_Field, -Entradas),
               y=Entradas,
               fill=Research_Field
             )) +
        geom_bar(stat="identity")+
        #coord_flip()+
        theme_classic() +
        ylab("Data Points")+
        xlab("Research Field")+
        theme(axis.text.x = element_text(hjust = 1,
                                         #size=11,
                                         angle=45))#,
              # axis.text.y = element_text(size = 11),
              # legend.position = "none",
              # axis.title = element_text(size=12)
        # )

```

## Subject Analysis
There is a total of `r nrow(Species)` subjects in the metadata. The subject that has the most amount of data points is `r Species[1,1]` with `r Species[1,2]` units. However, at the species level, *Thunnus albacares* (Albacore tuna) is the most recurrent one with `r Species[42,2]` records. The data distribution is very diverse since the mean data point is `r Mean`(sd `r SD`). This is mainly because a large amount of records are one observation of species lists.

```{r Geographic, echo = F, eval= T}

#Geo Area#
Geo <- Template %>% 
        group_by(Area) %>% 
        summarise(Entradas = sum(Data_Time_Points,na.rm=T)) %>% 
        filter(Area !="na") %>% 
        filter(Area != "TBD") 
Pacific <- Geo %>% 
  filter(Area =="Pacific")

Atlantic <- Geo %>% 
  filter(Area =="Pacific")

#Geo Region#
Geo_R <- Template %>% 
        group_by(Region) %>% 
        summarise(Entradas = sum(Data_Time_Points,na.rm=T)) %>% 
        filter(Region !="NA") %>% 
        filter(Region != "TBD") %>% 
  arrange(desc(Entradas))

GC_R <- Geo_R %>% 
  filter(Region =="Gulf of California")

BC_R <- Geo_R %>% 
  filter(Region =="Banco Campeche Caribe")
      
```

## Geographic Analysis
In terms of regional data distribution, data points where evenly distributed between both the Pacific (`r Pacific[1,2]`) and the Atlantic oceans (`r Atlantic[1,2]`). However, the great majority of data points are reported at a National level (`r Geo[1,2]`). At a more detailed level we find that there is a clear dominance of data from both the Gulf of California (`r GC_R[1,2]`) and the Campeche Bank (`r BC_R[1,2]`), in respect to the other zones determined by the working group.

```{r Fig2, eval=T, echo=F, fig.align="center",fig.height=4,fig.width=7,fig.cap="OPTION 1. Number of data points per geographic area for each research field."}

Geo_Plot <- Template %>% 
        group_by(Area,Research_Field) %>% 
        summarise(Entradas = sum(Data_Time_Points,na.rm=T)) %>% 
        filter(Area !="na") %>% 
        filter(Area != "TBD") 

ggplot(data= Geo_Plot,
             aes(
               x=reorder(Area, -Entradas),
               y=Entradas,
               fill=Research_Field
             )) +
        geom_bar(stat="identity")+
        #coord_flip()+
        theme_classic() +
        ylab("Data Points")+
        xlab("Research Field")+
        theme(axis.text.x = element_text(hjust = 1,
                                         angle=45))#,
                                         # size=11,),
              # axis.text.y = element_text(size = 11),
              # legend.position = "top",
              # axis.title = element_text(size=11))
                                        
```
# Discussion
# Literature Review